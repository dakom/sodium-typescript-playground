module.exports = { contents: "\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SelfDisposingContainer_1 = require(\"../../../lib/display/SelfDisposingContainer\");\r\nvar DrumMachine_UI_1 = require(\"./DrumMachine_UI\");\r\nvar sodiumjs_1 = require(\"sodiumjs\");\r\nvar R = require(\"ramda\");\r\nvar Timer = (function (_super) {\r\n    __extends(Timer, _super);\r\n    function Timer() {\r\n        var _this = _super.call(this) || this;\r\n        //visual setup\r\n        _this._row = new DrumMachine_UI_1.Row_UI(0xff0000, 0xcccccc);\r\n        _this.addChild(_this._row);\r\n        return _this;\r\n    }\r\n    Timer.prototype.start = function (cSpeed) {\r\n        var _this = this;\r\n        //just tinkered till it felt okay\r\n        var getSpeed = function (speedFactor) { return R.clamp(20, 1000, Math.exp(speedFactor * -5) * 1000); };\r\n        //timer setup\r\n        var sys = new sodiumjs_1.MillisecondsTimerSystem();\r\n        var time = sys.time;\r\n        var oAlarm = new sodiumjs_1.CellLoop();\r\n        var sAlarm = sys.at(oAlarm);\r\n        var nextAlarm = sAlarm.snapshot3(oAlarm, cSpeed, function (ms, alarmTime, speedFactor) { return alarmTime + getSpeed(speedFactor); });\r\n        //set the first alarm. time.sample() is Date.now()\r\n        oAlarm.loop(nextAlarm.hold(time.sample() + getSpeed(cSpeed.sample())));\r\n        //create a cell to represet the measure, which is updated by the alarm\r\n        var cMeasure = new sodiumjs_1.CellLoop();\r\n        cMeasure.loop(nextAlarm.snapshot(cMeasure, function (rawTime, measureTime) { return (measureTime < 15) ? measureTime + 1 : 0; })\r\n            .hold(0));\r\n        this._cMeasure = cMeasure;\r\n        //visual updates when measure changes\r\n        this.unlisten = this._cMeasure.listen(function (measure) {\r\n            _this._row.children\r\n                .forEach(function (block, index) { return block.redraw(measure === index); });\r\n        });\r\n    };\r\n    Object.defineProperty(Timer.prototype, \"cMeasure\", {\r\n        get: function () {\r\n            return this._cMeasure;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Timer.prototype.dispose = function () {\r\n        this.unlisten();\r\n    };\r\n    return Timer;\r\n}(SelfDisposingContainer_1.SelfDisposingContainer));\r\nexports.Timer = Timer;\r\n//# sourceMappingURL=DrumMachine_Timer.js.map",
dependencies: ["../../../lib/display/SelfDisposingContainer","./DrumMachine_UI","sodiumjs","ramda"],
sourceMap: "{\"version\":3,\"file\":\"app/modules/drum_machine/DrumMachine_Timer.js\",\"sourceRoot\":\"\",\"sources\":[\"/src/app/modules/drum_machine/DrumMachine_Timer.ts\"],\"names\":[],\"mappings\":\";;;;;;;;;;;;AAAA,sFAAqF;AAErF,mDAAkD;AAClD,qCAA6G;AAC7G,yBAA2B;AAE3B;IAA2B,yBAAsB;IAM7C;QAAA,YACI,iBAAO,SAKV;QAHG,cAAc;QACd,KAAI,CAAC,IAAI,GAAG,IAAI,uBAAM,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAC3C,KAAI,CAAC,QAAQ,CAAC,KAAI,CAAC,IAAI,CAAC,CAAC;;IAC7B,CAAC;IAEM,qBAAK,GAAZ,UAAa,MAAmB;QAAhC,iBA8BC;QA7BG,iCAAiC;QACjC,IAAM,QAAQ,GAAG,UAAC,WAAkB,IAAK,OAAA,CAAC,CAAC,KAAK,CAAC,EAAE,EAAC,IAAI,EAAC,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAlD,CAAkD,CAAC;QAE5F,aAAa;QACb,IAAM,GAAG,GAAG,IAAI,kCAAuB,EAAE,CAAC;QAC1C,IAAM,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;QACtB,IAAM,MAAM,GAAG,IAAI,mBAAQ,EAAU,CAAC;QACtC,IAAM,MAAM,GAAG,GAAG,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAE9B,IAAM,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,EAAE,UAAC,EAAE,EAAC,SAAS,EAAE,WAAW,IAAK,OAAA,SAAS,GAAG,QAAQ,CAAC,WAAW,CAAC,EAAjC,CAAiC,CAAC,CAAC;QAGrH,kDAAkD;QAClD,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAEvE,sEAAsE;QACtE,IAAM,QAAQ,GAAG,IAAI,mBAAQ,EAAU,CAAC;QAExC,QAAQ,CAAC,IAAI,CACT,SAAS,CAAC,QAAQ,CAAC,QAAQ,EAAE,UAAC,OAAO,EAAC,WAAW,IAAK,OAAA,CAAC,WAAW,GAAG,EAAE,CAAC,GAAG,WAAW,GAAG,CAAC,GAAG,CAAC,EAAxC,CAAwC,CAAC;aAC9F,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QAEd,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAE1B,qCAAqC;QACrC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,OAAO;YACzC,KAAI,CAAC,IAAI,CAAC,QAAQ;iBACb,OAAO,CAAC,UAAC,KAAK,EAAE,KAAK,IAAK,OAAC,KAAkB,CAAC,MAAM,CAAC,OAAO,KAAK,KAAK,CAAC,EAA7C,CAA6C,CAAC,CAAC;QAClF,CAAC,CAAC,CAAA;IACN,CAAC;IAED,sBAAW,2BAAQ;aAAnB;YACI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;QAC1B,CAAC;;;OAAA;IAED,uBAAO,GAAP;QACI,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAEL,YAAC;AAAD,CAAC,AAtDD,CAA2B,+CAAsB,GAsDhD;AAtDY,sBAAK\"}",
headerContent: undefined,
mtime: 1504029030253,
devLibsRequired : undefined
};